<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button class="menu-button" (click)="openMenu()">
        <div class="menu-icon">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </ion-button>
    </ion-buttons>
    <ion-title></ion-title>
  </ion-toolbar>
</ion-header>

<!-- Menu lateral DENTRO do ion-content -->
<div class="menu-overlay" id="menuOverlay" (click)="closeMenu()"></div>

<div class="menu-drawer" id="menuDrawer">
  <button class="menu-close" (click)="closeMenu()">√ó</button>

  <div (click)="closeMenu()" class="menu-header">
    <div class="menu-company" style="font-size: 1.4rem; font-weight: 700; color: #ffffff;">OvinoSync</div>
    <div class="menu-logo">
      <img src="assets/images/logo-ovino.png" alt="Logo OvinoSync">
    </div>
    <div class="menu-user">{{ getNomeUsuario() }}</div>
</div>

  <div class="menu-items">
    <!-- Se√ß√£o Principal -->
    <a class="menu-item" (click)="navegarPara('/dashboard'); closeMenu()">
      <ion-icon name="home-outline"></ion-icon>
      <span class="menu-item-text">In√≠cio</span>
    </a>

    <a class="menu-item" (click)="navegarPara('/lista-animais'); closeMenu()">
      <ion-icon name="git-compare-outline"></ion-icon>
      <span class="menu-item-text">Todos os Animais</span>
    </a>

    <a class="menu-item" (click)="navegarPara('/manejos'); closeMenu()">
      <ion-icon name="clipboard-outline"></ion-icon>
      <span class="menu-item-text">Manejos</span>
    </a>

    <a class="menu-item" (click)="navegarPara('/cadastro-animais'); closeMenu()">
      <ion-icon name="add-circle-outline"></ion-icon>
      <span class="menu-item-text">Cadastrar Animal</span>
    </a>

    <!-- Divisor -->
    <div class="menu-divider"></div>

    <!-- Se√ß√£o Secund√°ria -->
    <a class="menu-item" (click)="abrirPerfil(); closeMenu()">
      <ion-icon name="person-outline"></ion-icon>
      <span class="menu-item-text">Perfil</span>
    </a>

    <a class="menu-item" (click)="abrirAjuda(); closeMenu()">
      <ion-icon name="help-circle-outline"></ion-icon>
      <span class="menu-item-text">Ajuda</span>
    </a>

    <a class="menu-item" (click)="sair(); closeMenu()">
      <ion-icon name="log-out-outline"></ion-icon>
      <span class="menu-item-text">Sair</span>
    </a>
  </div>
</div>

<ion-content [fullscreen]="true" class="dashboard-content">
  <div class="container">
    <!-- HEADER DO DASHBOARD -->
    <header class="dashboard-header">
      <div class="header-content">
        <div class="header-title">
          <h1>Ovinocultura de Precis√£o</h1>
          <p>Monitoramento completo do seu rebanho ovino</p>
        </div>
        <div class="user-info">
          <div class="user-avatar">
            <ion-icon name="person"></ion-icon>
          </div>
        </div>
      </div>
    </header>

    <!-- TOTAL DE ANIMAIS -->
    <ion-card class="stats-card" (click)="navegarPara('/lista-animais')">
      <ion-card-header class="card-header">
        <ion-card-title>Total de Animais</ion-card-title>
        <div class="card-icon icon-animals">
          <ion-icon name="git-compare-outline"></ion-icon>
        </div>
      </ion-card-header>
      <ion-card-content>
        <div class="stat-number">{{ dadosDashboard.totalAnimais }}</div>
        <div class="stat-change">
          <span class="change-positive" *ngIf="dadosDashboard.totalAnimais > 0">
            <ion-icon name="arrow-up"></ion-icon>
            Sistema ativo
          </span>
          <span class="change-neutral" *ngIf="dadosDashboard.totalAnimais === 0">
            <ion-icon name="refresh"></ion-icon>
            Carregando...
          </span>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- F√äMEAS GESTANTES -->
    <ion-card class="stats-card" (click)="navegarParaGestantes()">
      <ion-card-header class="card-header">
        <ion-card-title>F√™meas Gestantes</ion-card-title>
        <div class="card-icon icon-pregnant">
          <ion-icon name="heart-circle-outline"></ion-icon>
        </div>
      </ion-card-header>
      <ion-card-content>
        <div class="stat-number">{{ dadosDashboard.femeasGestantes }}</div>
        <div class="stat-change">
          <span class="change-positive" *ngIf="dadosDashboard.femeasGestantes > 0">
            <ion-icon name="arrow-up"></ion-icon>
            Em reprodu√ß√£o
          </span>
          <span class="change-neutral" *ngIf="dadosDashboard.femeasGestantes === 0">
            <ion-icon name="heart-outline"></ion-icon>
            Sem gesta√ß√µes
          </span>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- ANIMAIS PARA DESCARTE -->
    <ion-card class="stats-card" (click)="navegarParaAnimaisDescarte()">
      <ion-card-header class="card-header">
        <ion-card-title>Animais para Descarte</ion-card-title>
        <div class="card-icon icon-discard">
          <ion-icon name="warning-outline"></ion-icon>
        </div>
      </ion-card-header>
      <ion-card-content>
        <div class="stat-number">{{ dadosDashboard.animaisDescarte }}</div>
        <div class="stat-change">
          <span class="change-warning" *ngIf="dadosDashboard.animaisDescarte > 0">
            <ion-icon name="warning"></ion-icon>
            Aten√ß√£o necess√°ria
          </span>
          <span class="change-positive" *ngIf="dadosDashboard.animaisDescarte === 0">
            <ion-icon name="checkmark"></ion-icon>
            Todos saud√°veis
          </span>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- CONDI√á√ïES CLIM√ÅTICAS - COM DADOS REAIS -->
  <ion-card class="weather-card">
    <ion-card-header class="card-header">
      <ion-card-title>Condi√ß√µes Clim√°ticas</ion-card-title>
      <div class="card-icon icon-weather">
        <ion-icon [name]="getWeatherIcon()"></ion-icon>
      </div>
    </ion-card-header>
    <ion-card-content>
      <div class="weather-content">
        <div>Temperatura</div>
        <div class="weather-temp">{{ dadosDashboard.clima.temperatura }}¬∞C</div>

        <div class="weather-stats">
          <div class="weather-stat">
            <div class="weather-stat-label">Umidade</div>
            <div class="weather-stat-value">{{ dadosDashboard.clima.umidade }}%</div>
          </div>
          <div class="weather-stat">
            <div class="weather-stat-label">Vento</div>
            <div class="weather-stat-value">{{ dadosDashboard.clima.vento }} km/h</div>
          </div>
          <div class="weather-stat">
            <div class="weather-stat-label">Chuva</div>
            <div class="weather-stat-value">{{ dadosDashboard.clima.chuva }}%</div>
          </div>
        </div>

        <div class="weather-forecast">
          {{ dadosDashboard.clima.previsao }}
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- SE√á√ÉO DE ALERTAS -->
  <h2 class="section-title">Alertas e Lembretes</h2>

  <div class="grid-2">
    <!-- RASCUNHOS DE PARTO PENDENTES - S√ì APARECE SE HOUVER -->
    <ion-card class="alerts-card" *ngIf="temRascunhosPendentes()">
      <ion-card-header class="card-header">
        <ion-card-title>Partos com Cadastro Incompleto</ion-card-title>
        <div class="card-icon icon-warning">
          <ion-icon name="document-text-outline"></ion-icon>
        </div>
      </ion-card-header>
      <ion-card-content>
        <div class="rascunhos-list">
          <div *ngFor="let rascunho of rascunhosPendentes" class="rascunho-item">
            <div class="rascunho-info">
              <div class="rascunho-mae">üêë {{ rascunho.mae_brinco }}</div>
              <div class="rascunho-data">Iniciado em {{ formatarDataRascunho(rascunho.data_criacao) }}</div>
              <div class="rascunho-filhotes">{{ rascunho.total_filhotes }} filhote(s) preenchido(s)</div>
            </div>
            <div class="rascunho-actions">
              <ion-button size="small" fill="solid" (click)="continuarRascunho(rascunho)">
                Continuar
              </ion-button>
              <ion-button size="small" fill="outline" color="medium" (click)="excluirRascunho(rascunho)">
                Excluir
              </ion-button>
            </div>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- MENSAGEM "SEM ALERTAS" - S√ì APARECE SE N√ÉO HOUVEREM RASCUNHOS -->
    <ion-card class="alerts-card" *ngIf="!temRascunhosPendentes()">
      <ion-card-content>
        <div class="empty-state">
          <ion-icon name="notifications-off-outline" class="empty-icon"></ion-icon>
          <h4>Sem alertas no momento</h4>
          <p>Seu rebanho est√° em dia com os cuidados</p>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- ATIVIDADES RECENTES -->
  <h2 class="section-title">Atividades Recentes</h2>

  <ion-card class="activities-card" *ngIf="!temAtividadesRecentes()">
    <ion-card-content>
      <div class="empty-state">
        <ion-icon name="time-outline" class="empty-icon"></ion-icon>
        <h4>Nenhuma atividade recente</h4>
        <p>As atividades aparecer√£o aqui</p>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-card class="activities-card" *ngIf="temAtividadesRecentes()">
    <ion-card-content>
      <div class="activities-list">
        <div *ngFor="let atividade of atividadesRecentes" class="activity-item">
          <div class="activity-icon">
            {{ getAtividadeIcon(atividade.tipo) }}
          </div>
          <div class="activity-content">
            <div class="activity-title">{{ atividade.titulo }}</div>
            <div class="activity-desc" *ngIf="atividade.descricao">{{ atividade.descricao }}</div>
            <div class="activity-meta">
              <span class="activity-type">{{ atividade.tipo }}</span>
              ‚Ä¢
              <span class="activity-time">{{ formatarDataAtividade(atividade.data_acao) }}</span>
            </div>
          </div>
        </div>
      </div>
    </ion-card-content>
  </ion-card>
</ion-content>